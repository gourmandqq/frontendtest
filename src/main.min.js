import"./styles/main.min.css";import Cart from"./cart.js";class PageSearch{constructor(){this.searchInput=document.getElementById("search-input"),this.searchButton=document.getElementById("search-button"),this.currentIndex=-1,this.matches=[],this.init()}init(){this.searchButton.addEventListener("click",()=>this.search()),this.searchInput.addEventListener("keypress",e=>{"Enter"===e.key&&this.search()})}search(){const e=this.searchInput.value.trim();if(!e)return void alert("Введите поисковый запрос");this.clearHighlights(),this.matches=[];const t=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,!1);let i;for(;i=t.nextNode();){const t=i.textContent,s=new RegExp(`(${this.escapeRegex(e)})`,"gi");if([...t.matchAll(s)].length>0){const e=document.createElement("span");e.innerHTML=t.replace(s,'<mark class="search-highlight">$1</mark>'),i.parentNode.replaceChild(e,i);e.querySelectorAll("mark").forEach(e=>{this.matches.push(e)})}}this.matches.length>0?(this.matches[0].scrollIntoView({behavior:"smooth",block:"center"}),alert(`Найдено совпадений: ${this.matches.length}`)):alert("Ничего не найдено")}clearHighlights(){document.querySelectorAll(".search-highlight").forEach(e=>{const t=e.parentNode;t.replaceWith(t.textContent)})}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}class Slider{constructor(){this.slides=document.querySelectorAll(".slide"),this.dots=document.querySelectorAll(".pagination-dot"),this.prevBtn=document.querySelector(".slider-arrow-prev"),this.nextBtn=document.querySelector(".slider-arrow-next"),this.currentSlide=0,this.init()}init(){this.prevBtn.addEventListener("click",()=>this.prevSlide()),this.nextBtn.addEventListener("click",()=>this.nextSlide()),this.dots.forEach(e=>{e.addEventListener("click",e=>{const t=parseInt(e.target.dataset.slide);this.goToSlide(t)})})}nextSlide(){this.currentSlide=(this.currentSlide+1)%this.slides.length,this.updateSlider()}prevSlide(){this.currentSlide=(this.currentSlide-1+this.slides.length)%this.slides.length,this.updateSlider()}goToSlide(e){this.currentSlide=e,this.updateSlider()}updateSlider(){this.slides.forEach((e,t)=>{e.classList.toggle("active",t===this.currentSlide)}),this.dots.forEach((e,t)=>{e.classList.toggle("active",t===this.currentSlide)})}}class ActiveMenu{constructor(){this.menuLinks=document.querySelectorAll(".menu nav ul li a"),this.init()}init(){this.menuLinks.forEach(e=>{e.addEventListener("click",t=>{this.setActiveLink(e)})}),this.setActiveFromHash(),window.addEventListener("hashchange",()=>this.setActiveFromHash())}setActiveLink(e){this.menuLinks.forEach(e=>{e.classList.remove("active")}),e.classList.add("active"),localStorage.setItem("activeMenuLink",e.getAttribute("href"))}setActiveFromHash(){const e=window.location.hash;if(e){const t=document.querySelector(`.menu nav ul li a[href="${e}"]`);t&&this.setActiveLink(t)}else{const e=localStorage.getItem("activeMenuLink");if(e){const t=document.querySelector(`.menu nav ul li a[href="${e}"]`);t&&this.setActiveLink(t)}}}}document.addEventListener("DOMContentLoaded",()=>{new Slider,new PageSearch,new ActiveMenu,new Cart});